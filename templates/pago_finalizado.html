{% extends "base.html" %}
{% load static %}

{% block title %}Pago exitoso - SOS{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/pago_finalizado.css' %}">
{% endblock %}

{% block content %}

<div class="pf-wrapper">
  <div class="pf-card shadow-sm">

    <input type="hidden" id="eta_minutes" value="{{ eta_minutes }}">
    <input type="hidden" id="order_created" value="{{ order.created_at|date:'Y-m-d\\TH:i:s' }}">

    <div class="pf-emoji">ðŸŽ‰</div>
    <h1 class="pf-title">Â¡Pago procesado con Ã©xito!</h1>
    <p class="pf-sub">Gracias por tu compra ðŸ¦ž</p>
    <p class="pf-sub">Tu pedido ha sido confirmado y estÃ¡ en preparaciÃ³n.</p>

    <!-- === BOLETA === -->
    <div class="pf-boleta">
      <h3>ðŸ§¾ Boleta electrÃ³nica</h3>

      <p><b>Cliente:</b> {{ order.customer.name }}</p>
      <p><b>Correo:</b> {{ order.customer.email|default:"â€”" }}</p>
      <p><b>Pedido NÂ°:</b> {{ order.id }}</p>
      <p><b>Fecha:</b> {{ order.created_at|date:"d-m-Y H:i" }}</p>

      <hr>

      <p><b>Items:</b></p>
      <ul>
        {% for item in items %}
        <li>{{ item.qty }}Ã— {{ item.product_name }} â€” ${{ item.subtotal }}</li>
        {% empty %}
        <li>Sin productos.</li>
        {% endfor %}
      </ul>

      <hr>

      <p class="pf-total">
        <b>Total pagado:</b>
        <span>${{ order.total_price }}</span>
      </p>
    </div>

    <!-- === TIMER REAL === -->
    <div class="pf-timer" id="timer">
      Pedido listo en <b>{{ eta_minutes }}:00</b>
    </div>

    <a href="/" class="pf-btn">Volver al inicio</a>

  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/pago_finalizado.js' %}" defer></script>
{% endblock %}
